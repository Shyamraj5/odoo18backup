<odoo>
    <template id="sale_report_template">
        <t t-call="web.html_container">
            <t t-call="diet.sale_report_header">
                <div class="page" style="font-family: Arial, sans-serif; padding: 20px;">
                    <style>
                        /* Matching the green theme */
                        .table {
                            page-break-after: avoid !important;
                            border-collapse: collapse;
                            width: 100%;
                            margin-top: 20px;
                            border: 1px solid #629f6f; /* Darker green border */
                        }

                        /* Center the text within the table */
                        .div {
                            font-family: 'Exo-2', sans-serif;
                            vertical-align: middle;
                            display: flex;
                            justify-content: center;  /* Centers horizontally */
                            align-items: center;      /* Centers vertically *//* Make sure the parent div has a defined height */
                            text-align: center;     
                        }

                        .center {
                            margin: auto;
                            width: 100%;
                            padding: 15px;
                            vertical-align: middle;
                        }

                        /* Styling the table header */
                        thead {
                            background-color: #b5e0c8; /* Lighter green header */
                            border-color: #629f6f; /* Dark green border for table */
                        }

                        /* Styling table body and rows */
                        tbody tr:nth-child(even) {
                            background-color: #eaf7eb; /* Softest green for alternating rows */
                        }

                        tbody tr:nth-child(odd) {
                            background-color: #ffffff; /* Keep odd rows white for contrast */
                        }

                        tbody tr {
                            border: 1px solid #629f6f; /* Consistent dark green border for all rows */
                        }

                        /* Styling table header cells */
                        th {
                            color: #2d604a; /* Darker green text */
                            padding: 8px;
                            text-align: center;
                            vertical-align: middle;
                            border: 1px solid #629f6f; /* Same border as the table */
                        }

                        /* Styling table data cells */
                        td {
                            padding: 10px;
                            border: 1px solid #629f6f; /* Darker green for data cell borders */
                        }

                        /* Styling Monthly Revenue row */
                        tr.monthly-revenue-row {
                            background-color: #d6eddb; /* Slightly darker green for total row */
                        }

                        th.monthly-revenue-header {
                            text-align: left;
                            padding-left: 10px;
                        }
                        
                        td.monthly-revenue-total {
                            text-align: right;
                            padding-right: 10px;
                        }
                    </style>

                    <main style="margin-top: 20px;">
                        <div class="div center" width="100%" height="100px" style="background-color:#b5e0c8;height: 80px;text-align:center;">
                            <h2 style="text-align: center;font-family: Exo-2;font-color:#629f6f;padding-top:15px" >
                                Monthly Sales Report
                            </h2>
                        </div>

                        <table class="table">
                            <thead>
                                <t t-set="i" t-value="1" />
                                <tr>
                                    <th t-attf-rowspan="2">Month</th>
                                    <th t-attf-rowspan="2">Monthly Revenue</th>
                                    <th colspan="3">Meal Details</th>
                                </tr>
                                <tr>
                                    <th>Plan</th>
                                    <th>Plan Count</th>
                                    <th>Plan Revenue</th>
                                </tr>
                            </thead>
                            
                            <tbody>
                                <t t-set="plan_count" t-value="len(doc_ids.plan_id)+1" />
                                <tr>
                                    <td t-attf-rowspan="#{plan_count}" style="vertical-align: middle;">
                                        <t t-esc="month"/>
                                    </td>
                                    <td t-attf-rowspan="#{plan_count}" style="text-align: center; vertical-align: middle;">
                                        <t t-set="total_amount" t-value="sum(map(lambda o: o.grand_total, doc_ids))"/>
                                        <t t-esc="total_amount" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                    </td>
                                </tr>

                                <t t-foreach="report_data['plan_data']" t-as="plan">
                                    <tr>
                                        <td>
                                            <t t-esc="plan.get('plan_name')"/>
                                        </td>
                                        <td style="text-align: center">
                                            <t t-esc="plan.get('plan_counts')"/>
                                        </td>
                                        <td style="text-align: right;">
                                            <t t-set="plan_rev" t-value="plan.get('plan_revenue')"/>
                                            <span t-esc="plan_rev" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                        </td>
                                    </tr>
                                </t>
                                
                                <tr class="monthly-revenue-row">
                                    <th colspan="4" class="monthly-revenue-header">Monthly Revenue</th>
                                    <td class="monthly-revenue-total">
                                        <t t-set="total_amount" t-value="sum(map(lambda o: o.grand_total, doc_ids))"/>
                                        <span t-esc="total_amount" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                    </td>
                                    
                                </tr>
                            </tbody>
                        </table>
                    </main>
                </div>
            </t>
        </t>
    </template>
</odoo>
