<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_post_dated_check_list" model="ir.ui.view">
            <field name="name">view.post.dated.check.list</field>
            <field name="model">post.dated.check</field>
            <field name="type">list</field>
            <field name="mode">primary</field>
            <field eval="16" name="priority"/>
            <field eval="True" name="active"/>
            <field name="arch" type="xml">
                <list create="true" delete="true" edit="true" string="PDC">
                    <field name="name"/>
                    <field name="date"/>
                    <field name="ref_no"/>
                    <field name="partner_id"/>
                    <field name="check_date"/>
                    <field name="check_number" required="1"/>
                    <field name="check_amount"/>
                    <field invisible="1" name="currency_id"/>
                    <field name="state"/>
                </list></field>
        </record>
        <record id="view_post_dated_check_form" model="ir.ui.view">
            <field name="name">view.post.dated.check.form</field>
            <field name="model">post.dated.check</field>
            <field name="type">form</field>
            <field name="mode">primary</field>
            <field eval="16" name="priority"/>
            <field eval="True" name="active"/>
            <field name="arch" type="xml">
                <form create="true" delete="true" edit="true" string="PDC">
                    <header>
                        <field invisible="1" name="pdc_type"/>
                        <button class="oe_highlight" invisible="not is_send_receive_visible" name="action_pdc_send_receive" string="Post" type="object"/>
                        <button class="oe_highlight" invisible="pdc_type == 'vendor' or state not in ['draft']" name="action_pdc_send_receive" string="Receive PDC" type="object"/>
                        <button class="oe_highlight" invisible="state not in ['received','submitted']" name="action_pdc_deposit" string="Deposit" type="object"/>
                        <button class="oe_highlight" invisible="state not in ['received','submitted']" name="action_pdc_bounce" string="Bounce" type="object"/>
                        <button class="oe_highlight" invisible="state not in ['submitted']" name="cancel_entry" string="Cancel" type="object"/>
                        <button name="action_done" class="oe_highlight" invisible="1" string="Reconcile" type="object"/>
                        <button name="action_approve_line"
                                string="Approve"
                                type="object"
                                class="oe_highlight"
                                invisible="is_all_approved"/>
                        <button name="action_reject_line"
                                string="Reject"
                                type="object"
                                class="oe_highlight"
                                invisible="is_all_approved"
                                modifiers="{'invisible': [('role_id', 'not in', [user.employee_id.job_id.id] + user.employee_id.job_ids.ids)]}"/>
                        <!-- invisible="state not in ['deposited']" -->
                        <field name="state" statusbar_visible="draft,deposited" widget="statusbar"/>
                    </header>
                    <sheet>
                        <field invisible="1" name="is_submitted_received_shown"/>
                        <field invisible="1" name="is_bounced_shown"/>
                        <field invisible="1" name="is_deposited_shown"/>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" icon="fa-search" invisible="pdc_type == 'customer' or is_submitted_received_shown == False" name="action_open_submit_receive_moves" string="Submitted Moves" type="object">
                            </button>
                            <button class="oe_stat_button" icon="fa-search" invisible="pdc_type == 'vendor' or is_submitted_received_shown == False" name="action_open_submit_receive_moves" string="Received Moves" type="object">
                            </button>
                            <button class="oe_stat_button" icon="fa-search" invisible="is_bounced_shown == False" name="action_open_bounced_moves" string="Bounced Moves" type="object">
                            </button>
                            <button class="oe_stat_button" icon="fa-search" invisible="is_deposited_shown == False" name="action_open_deposited_moves" string="Deposited Moves" type="object">
                            </button>
                            <!-- payment matching  -->
                            <button class="oe_stat_button" icon="fa-usd" invisible="1" name="action_open_reconcile" string="Match Payments" type="object"/>
                            <!-- invisible="state not in ['received','submitted','deposited']" -->
                            <button class="oe_stat_button" icon="fa-usd" invisible="1" name="open_reconciled_moves" string="Entries" type="object">
                                <field name="reconciled_moves_count"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <label class="oe_edit_only" for="name"/>
                            <h1>
                                <field class="oe_inline" name="name" nolabel="1" readonly="1"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="date" readonly="state in ('cancel', 'deposited')"/>
                                <field name="ref_no" readonly="state in ('cancel', 'deposited')"/>
                                <field invisible="1" name="customer_domain"/>
                                <field domain="customer_domain" name="partner_id" readonly="state in ('cancel', 'deposited')"/>
                                <field invisible="1" name="is_temp_partner"/>
                                <field invisible="is_temp_partner == False" name="partner_name"/>
                                <field invisible="1" name="account_new_id"/>
                                <field name="check_number" readonly="state in ('cancel', 'deposited')"/>
                                <field name="check_date" readonly="state in ('cancel', 'deposited')"/>
                                <field name="check_amount" force_save="1" readonly="1"/>
                                <field invisible="1" name="prepared_id"/>
                                <field name="payment_type" readonly="1"/>
                                <field name="memo"/>
                            </group>
                            <group>
                                <field force_save="1" invisible="1" name="journal_id" readonly="state in ('cancel', 'deposited')"/>
                                <field name="currency_id" readonly="state in ('cancel', 'deposited')"/>
                                <field force_save="1" name="company_id" readonly="state in ('cancel', 'deposited')"/>
                                <!--<field name="analytic_account_id" invisible="1" attrs="{'readonly': [('state','in',('cancel','deposited'))]}"/>-->
                                <field invisible="state != 'cancel'" name="cancel_journal_entry" readonly="1"/>
                                <field name="analytic_distribution" widget="analytic_distribution" invisible ="1"/>
                                <!--<field name="analytic_tag_ids" widget="many2many_tags" invisible="1"/>-->
                                <field force_save="1" name="bank_journal_id" readonly="state in ('cancel', 'deposited')"/>
                                <field name="account_id" readonly="1" string="Bank Deposit Account" />
                                <field name="payment_approval" required="1" options="{'no_create': True, 'no_open': True, 'no_edit': True}"/>
                                <field name="is_all_approved" invisible="1"/>
                                <field name="is_send_receive_visible" invisible="1"/>
                                <!-- <field name = "invoice_ids" widget="many2many_binary"/> -->
                                <field name="discount_amount" widget="monetary" readonly="state in ('cancel', 'deposited')" invisible="1"/>
                                <field name="discount_account_id" readonly="state in ('cancel', 'deposited')" invisible="1"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Payment" >
                                <!-- invisible="state not in ['deposited', 'submitted']" -->
                                    <field name="payment_line_ids" nolabel="1" readonly="state in ('cancel', 'deposited')">
                                        <!-- readonly="state in ['draft', 'bounced']" -->
                                        <list editable="bottom" string="Payment">
                                            <field name="is_paid" column_invisible="1"/>
                                            <field name="invoice_id"  column_invisible="1"/>
                                            <field name="move_line_id" column_invisible="1"/>
                                            <field name="invoice_no" readonly="parent.state not in ('draft')"/>
                                            <field name="move_ref" string="Bill Reference"/>
                                            <field name="account_id" readonly="parent.state not in ('draft')"/>
                                            <field name="invoice_date" readonly="parent.state not in ('draft')"/>
                                            <field column_invisible="parent.payment_type != 'outbound'" name="vendor_reference"/>
                                            <!-- column_invisible="parent.payment_type != 'outbound'" -->
                                            <field name="invoice_duedate" readonly="0"/>
                                            <field name="amount" readonly="1" force_save="1" sum="Total"/>
                                            <field name="discount_perc" widget="percentage" column_invisible="1"/>
                                            <field name="discount_amt" column_invisible="1"/>
                                            <field name="balance" readonly="1" force_save="1" sum="Total" column_invisible="1"/>
                                            <field name="full_reconcile" readonly="parent.state not in ('draft')"/>
                                            <field name="amountpaid" force_save="1" readonly="1"/>
                                            <field name="deduction_amount" invisible="1"/>
                                        </list>
                                    </field>
                                <group class="oe_subtotal_footer oe_right" colspan="2" name="Total">
                                    <field name="total_discount" readonly="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                    <field class="oe_subtotal_footer_separator" name="amount_total" widget="monetary"/>
                                </group>
                            </page>
                            <page string="Approval Route">
                                <field name="approval_route_ids" force_save="1" readonly="1">
                                    <list editable="bottom">
                                        <field name="user_id"/>
                                        <field name="role_id"/>
                                        <field name="state"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Remarks">
                                <group>
                                    <field name="reason_for_reject"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <chatter reload_on_follower="True"/>
                </form></field>
        </record>
        <record id="view_pdc_filter" model="ir.ui.view">
            <field name="name">post.dated.check</field>
            <field name="model">post.dated.check</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <search string="Search">
                    <field name="name" string="Name"/>
                    <field name="date"/>
                    <filter domain="[('state','=','draft')]" help="Draft Vouchers" name="draft" string="Draft"/>
                    <separator/>
                    <filter domain="[('state','=','posted')]" help="To Review" name="toreview" string="To Review"/>
                    <field filter_domain="[('partner_id', 'child_of', self)]" name="partner_id"/>
                    <field context="{'journal_id': self, 'set_visible':False}" name="journal_id" widget="selection"/>
                    <field context="{'check_number': self, 'set_visible':False}" name="check_number" widget="selection"/>
                    <group expand="0" string="Group By">
                        <filter context="{'group_by':'partner_id'}" domain="[]" name="partner" string="Partner"/>
                        <filter context="{'group_by':'journal_id'}" domain="[]" name="journal" string="Journal"/>
                        <filter context="{'group_by':'date','visible':True}" domain="[]" name="date" string="Date"/>
                        <filter context="{'group_by':'state'}" domain="[]" name="status" string="Status"/>
                    </group>
                </search></field>
        </record>
        <record id="action_customer_post_dated_check_act_window" model="ir.actions.act_window">
            <field name="type">ir.actions.act_window</field>
            <field name="name">Customer PDC Payments</field>
            <field name="res_model">post.dated.check</field>
            <field name="view_mode">list,form</field>
            <field name="context">{'default_pdc_type': 'customer'}</field>
            <field name="domain">[('pdc_type','=','customer')]</field>
            <field name="target">current</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add new customer post dated check
                </p>
                <p>
                    Post Dated Checks are special types of checks which are only realised to
                corresponding bank account on the check date.
                </p></field>
        </record>
        <record id="menu_post_dated_check_customer" model="ir.ui.menu">
            <field name="name">Customer PDC Payments</field>
            <field eval="10" name="sequence"/>
            <field name="action" ref="action_customer_post_dated_check_act_window"/>
            <field name="parent_id" ref="account.menu_finance_receivables"/>
        </record>
        <record id="action_vendor_post_dated_check_act_window" model="ir.actions.act_window">
            <field name="type">ir.actions.act_window</field>
            <field name="name">Vendor PDC Payments</field>
            <field name="res_model">post.dated.check</field>
            <field name="view_mode">list,form</field>
            <field name="context">{'default_pdc_type': 'vendor','default_payment_type':'send_money'}</field>
            <field name="domain">[('pdc_type','=','vendor')]</field>
            <field name="target">current</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add new vendor post dated check
                </p>
                <p>
                    Post Dated Checks are special types of checks which are only realised to
                corresponding bank account on the check date.
                </p></field>
        </record>
        <record id="menu_post_dated_check_vendor" model="ir.ui.menu">
            <field name="name">Vendor PDC Payments</field>
            <field eval="10" name="sequence"/>
            <field name="action" ref="action_vendor_post_dated_check_act_window"/>
            <field name="parent_id" ref="account.menu_finance_payables"/>
        </record>
    </data>
</odoo>
